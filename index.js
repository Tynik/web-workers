!function(){"use strict";var e={d:function(t,n){for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})}};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),e.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},e.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},function(){var t;e.g.importScripts&&(t=e.g.location+"");var n=e.g.document;if(!t&&n&&(n.currentScript&&(t=n.currentScript.src),!t)){var r=n.getElementsByTagName("script");r.length&&(t=r[r.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),e.p=t}();var t,n={};function r(){return new Worker(e.p+"worker.worker.js")}e.r(n),e.d(n,{Task:function(){return h},TaskEvent:function(){return t},TaskWorker:function(){return s},useBrainJsTask:function(){return g},useTask:function(){return d}}),function(e){e.SENT="sent",e.STARTED="started",e.COMPLETED="completed",e.NEXT="next",e.ERROR="error"}(t||(t={}));class s extends Worker{}class i{constructor(){this.list={}}add(e,t,n=!1){this.list[e]||(this.list[e]=[]);const r=this.list[e].length;return this.list[e].push({id:r,callback:t,once:n}),{remove:()=>{this.removeById(e,r)}}}raise(e,t){(this.list[e]||[]).reduceRight(((n,{id:r,callback:s,once:i})=>{let o;try{o=s(t)}finally{!1!==o&&i&&this.removeById(e,r)}}),[])}get count(){return Object.keys(this.list).length}getCountCallbacks(e){var t;return(null===(t=this.list[e])||void 0===t?void 0:t.length)||0}remove(e){delete this.list[e]}clear(){this.list={}}removeById(e,t){const n=this.list[e].findIndex((e=>e.id===t));this.list[e].splice(n,1)}}const o=(e=9)=>Math.random().toString(36).substr(2,e);var u;Error,SyntaxError,function(e){e.FUNCTION="f"}(u||(u={}));const a=[Date,RegExp,Blob,File,FileList],c=e=>{return"function"==typeof e?[u.FUNCTION,String(e)]:null===(t=e)||a.some((e=>"number"==typeof t||"string"==typeof t||"boolean"==typeof t||t instanceof e))?[null,e]:Array.isArray(e)?[null,e.map((e=>c(e)))]:[null,Object.keys(e).reduce(((t,n)=>(t[n]=c(e[n]),t)),{})];var t};class h{constructor(e,{deps:t=[]}={}){this.func=e,this.deps=t,this.events=new i,this.init()}whenEvent(e,t,n=!1){return this.events.add(e,t,n)}whenNext(e,n=!1){return this.events.add(t.NEXT,e,n)}run(...e){this.stopped&&this.init();const n=o();this.sendMsgToWorker(n,{func:String(this.func),args:c(e),deps:this.deps});const r=this;return{get whenSent(){return r.whenRunEvent(t.SENT,n)},get whenStarted(){return r.whenRunEvent(t.STARTED,n)},get whenCompleted(){return r.whenRunEvent(t.COMPLETED,n)},get whenError(){return r.whenRunEvent(t.ERROR,n)},next:(...e)=>{const n=o();return this.sendMsgToWorker(n,{next:!0,args:e}),this.whenRunEvent(t.NEXT,n)},return:e=>{const t=o();this.sendMsgToWorker(t,{return:!0,args:[e]})},throw:e=>{const t=o();this.sendMsgToWorker(t,{throw:!0,args:[e]})}}}stop(){this.worker.terminate(),this.stopped=!0,this.queueLength=0}init(){this.queueLength=0,this.stopped=!1,this.worker=new r,this.worker.onmessage=e=>{const{data:{taskRunId:n,eventName:r,result:s,tookTime:i}}=e;[t.COMPLETED,t.NEXT,t.ERROR].includes(r)&&this.queueLength--,this.raiseEvent(r,n,{result:s,tookTime:i})}}addEvent(e,t,n){return this.events.add(e,(e=>{if(e.taskRunId!==t)return!1;n(e)}),!0)}whenRunEvent(e,n){return new Promise(((r,s)=>{this.addEvent(e,n,r),this.addEvent(t.ERROR,n,s)}))}raiseEvent(e,t,n){this.events.raise(e,Object.assign({taskRunId:t,queueLength:this.queueLength},n))}sendMsgToWorker(e,n){queueMicrotask((()=>{this.queueLength++,this.worker.postMessage(Object.assign({taskRunId:e},n)),this.raiseEvent(t.SENT,e)}))}}var l=require("react");const d=(e,n={},r=[])=>{const[s,i]=l.useState(null),[o,u]=l.useState(0),[a,c]=l.useState(!1),[d,g]=l.useState(null);return l.useEffect((()=>{const s=new h(e,n);if(s.whenEvent(t.SENT,(({queueLength:e})=>{u(e)})),s.whenEvent(t.STARTED,(()=>{i(!0)})),s.whenEvent(t.COMPLETED,(({queueLength:e})=>{i(!1),c(!0),u(e)})),s.whenEvent(t.NEXT,(()=>{i(!1)})),s.whenEvent(t.ERROR,(()=>{i(!1)})),r.length){const e=s.run.bind(s);s.run=(...t)=>e(...r,...t)}return g(s),()=>{s.stop()}}),[]),[d,{isRunning:s,queueLength:o,isCompleted:a}]},g=(e,t="latest",n={})=>{let r;return r=(e=>"GeneratorFunction"===e.constructor.name)(e)?function*(...e){yield*e[0].call(this,brain,...e.slice(1))}:function(...e){return e[0].call(this,brain,...e.slice(1))},d(r,Object.assign(Object.assign({},n),{deps:[`https://unpkg.com/brain.js@${t}/dist/brain-browser.js`,...n.deps||[]]}),[e])};module.exports=n}();
//# sourceMappingURL=index.js.map